<html>

	<script src='/socket.io/socket.io.js'></script>
	<script>
  		var socket = io.connect('http://localhost/admin');
  		function sendCommand() {
  			console.log('sending command...');
  			var command = document.getElementById('command').value;
  			socket.emit('command', command);
            document.getElementById('result').scrollIntoView();
  		}
        function doIncrement(inc){
            var element = document.getElementById('progressbar');
            var oldValue = parseInt(element.style.width);
            var newValue = oldValue + inc;
            element.style.width = newValue + '%';
            element['aria-valuenow'] = newValue;
            element.innerHTML = newValue + '%';
        };
        function increase() {
            console.log('increasing progress bar...');
            doIncrement(100);
        }
        socket.on('result', function (result){
            console.log('received result: ' + result);
            var resultOutput = document.getElementById('result');
            resultOutput.value = result;
        });
	</script>

    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link href="bootstrap/css/bootstrap.css" rel="stylesheet">
        <link href="bootstrap/css/bootstrap-theme.css" rel="stylesheet">

    </head>

	<body role="document">
        <!-- Fixed navbar -->
        <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">IO2014</a>
                </div>
                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <li class="active"><a href="#">Home</a></li>
                        <li><a href="#send">Task sending</a></li>
                        <li><a href="#progress">Progress bars</a></li>
                        <li><a href="#receive">Task results</a></li>
                    </ul>
                </div><!--/.nav-collapse -->
            </div>
        </div>

        <div class="container theme-showcase" role="main">

            <br>
            <br>
            <br>
            <br>

            <div class="jumbotron">
                <h1>Volunteer computing</h1>
            </div>

            <div class="page-header">
                <h1><a id="send">Task sending</a></h1>
            </div>

            <div class="page-header">
                <h3>Here we can post tasks to execute</h3>
            </div>

            <textarea class="col-md-12" style="margin-bottom: 50px; height: 400px" id='command'></textarea>

            <button type="button" class=" col-md-12 btn btn-lg btn-primary" onclick="sendCommand()">Send</button>

            <div class="col-md-12">
                <div class="page-header">
                    <h1><a id="progress">Progress bars</a></h1>
                </div>

                <div class="page-header">
                    <h3>We'll use progress bars to visualize task execution</h3>
                </div>

                <div class="progress progress-striped active">
                    <div id="progressbar" class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">0%</div>
                </div>

                <button type="button" class=" col-md-12 btn btn-lg btn-primary" onclick="increase()">Increase</button>

                <br>

                <div class="page-header">
                    <h1><a id="receive">Task results</a></h1>
                </div>

                <div class="page-header">
                    <h3>We will receive task results</h3>
                </div>

                <textarea readonly class="col-md-12" style="margin-bottom: 100px" id='result'></textarea>

            </div>
        </div>
    </body>

</html>

